name: Notify Downstream Repos

on:
  push:
    branches: [main]

jobs:
  notify:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        repo: [osprera, pilar-club]
    steps:
      - name: Trigger sync in ${{ matrix.repo }}
        uses: peter-evans/repository-dispatch@v3
        with:
          token: ${{ secrets.DOWNSTREAM_SYNC_TOKEN }}
          repository: jeancarlosleonvega/${{ matrix.repo }}
          event-type: upstream-sync
          client-payload: '{"ref": "${{ github.sha }}", "message": "${{ github.event.head_commit.message }}"}'
